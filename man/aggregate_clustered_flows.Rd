% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/linestring_aggregation.R
\name{aggregate_clustered_flows}
\alias{aggregate_clustered_flows}
\title{Aggregate clustered OD flows into representative lines}
\usage{
aggregate_clustered_flows(flows, weight = NULL, crs = sf::st_crs(flows))
}
\arguments{
\item{flows}{An \code{sf} object containing OD flows with coordinates for origins
(\code{x}, \code{y}) and destinations (\code{u}, \code{v}), a \code{cluster} column, and optionally
a \code{count} or other weighting variable.}

\item{weight}{(optional) Name of a column in \code{flows} to use for weighting.
If \code{NULL} (default), unweighted means are used.}

\item{crs}{Coordinate reference system for the output (default: taken from
\code{flows}).}
}
\value{
An \code{sf} object with one line per cluster, containing:
\itemize{
\item \code{count_total}: total weight (if provided), otherwise number of flows
\item \code{size}: the cluster size (from the input, not recomputed)
\item \code{geometry}: a \code{LINESTRING} representing the aggregated OD flow
}
}
\description{
This function aggregates flows within clusters and creates a single
representative line for each cluster. The start and end coordinates are
computed as weighted averages (weighted by flow counts or another variable),
or simple means if no weights are provided. Each cluster is represented
by one \code{LINESTRING}.
}
